# 機能一覧表

## 概要
TaskFlowシステムで実装する機能を、APIエンドポイント単位で優先度付きで整理します。

---

## 優先度の定義

| 優先度 | 説明 | 実装タイミング |
|--------|------|----------------|
| **P0 (Must Have)** | MVPに必須。これがないとシステムが機能しない | Phase 1 (Day68-74) |
| **P1 (Should Have)** | MVPに含めるべき。ユーザー体験を大きく向上させる | Phase 1 (Day68-74) |
| **P2 (Could Have)** | あると便利。時間があれば実装 | Phase 2 (Day75-85) |
| **P3 (Won't Have)** | 今回は実装しない。将来の拡張として検討 | Phase 3 (Day86-100) |

---

## 1. 認証・ユーザー管理

| # | 機能 | エンドポイント | メソッド | 優先度 | Phase | US |
|---|------|----------------|----------|--------|-------|-----|
| 1.1 | ユーザー登録 | `/api/v1/auth/signup` | POST | P0 | 1 | US-001 |
| 1.2 | ログイン | `/api/v1/auth/login` | POST | P0 | 1 | US-002 |
| 1.3 | プロフィール取得 | `/api/v1/users/me` | GET | P1 | 1 | US-003 |
| 1.4 | プロフィール更新 | `/api/v1/users/me` | PUT | P2 | 2 | - |
| 1.5 | パスワード変更 | `/api/v1/users/me/password` | PUT | P2 | 2 | - |
| 1.6 | ログアウト | `/api/v1/auth/logout` | POST | P3 | - | - |

**実装メモ**:
- JWTトークンベースの認証
- パスワードはbcryptでハッシュ化
- トークン有効期限: 24時間

---

## 2. プロジェクト管理

| # | 機能 | エンドポイント | メソッド | 優先度 | Phase | US |
|---|------|----------------|----------|--------|-------|-----|
| 2.1 | プロジェクト作成 | `/api/v1/projects` | POST | P0 | 1 | US-004 |
| 2.2 | プロジェクト一覧取得 | `/api/v1/projects` | GET | P0 | 1 | US-005 |
| 2.3 | プロジェクト詳細取得 | `/api/v1/projects/:id` | GET | P1 | 1 | US-006 |
| 2.4 | プロジェクト更新 | `/api/v1/projects/:id` | PUT | P1 | 1 | US-007 |
| 2.5 | プロジェクト削除 | `/api/v1/projects/:id` | DELETE | P3 | 3 | US-008 |
| 2.6 | プロジェクトアーカイブ | `/api/v1/projects/:id/archive` | POST | P2 | 2 | - |

**実装メモ**:
- 一覧取得はページネーション対応（limit/offset）
- ステータスフィルタ対応（active/archived/completed）
- 作成者が自動的にOwnerになる

---

## 3. タスク管理

| # | 機能 | エンドポイント | メソッド | 優先度 | Phase | US |
|---|------|----------------|----------|--------|-------|-----|
| 3.1 | タスク作成 | `/api/v1/projects/:projectId/tasks` | POST | P0 | 1 | US-009 |
| 3.2 | プロジェクトのタスク一覧 | `/api/v1/projects/:projectId/tasks` | GET | P0 | 1 | US-010 |
| 3.3 | 自分のタスク一覧 | `/api/v1/tasks/me` | GET | P0 | 1 | US-011 |
| 3.4 | タスク詳細取得 | `/api/v1/tasks/:id` | GET | P1 | 1 | US-012 |
| 3.5 | タスク更新 | `/api/v1/tasks/:id` | PUT | P1 | 1 | US-013 |
| 3.6 | タスクステータス変更 | `/api/v1/tasks/:id/status` | PATCH | P0 | 1 | US-014 |
| 3.7 | タスク削除 | `/api/v1/tasks/:id` | DELETE | P3 | 3 | US-015 |
| 3.8 | タスク検索 | `/api/v1/tasks/search` | GET | P2 | 2 | - |
| 3.9 | タスク一括更新 | `/api/v1/tasks/bulk` | PATCH | P3 | - | - |

**実装メモ**:
- 一覧取得はフィルタ対応（status/assignee/priority/label）
- ソート対応（priority/due_date/created_at）
- ページネーション対応
- ステータス遷移ルールを実装

---

## 4. コメント

| # | 機能 | エンドポイント | メソッド | 優先度 | Phase | US |
|---|------|----------------|----------|--------|-------|-----|
| 4.1 | コメント追加 | `/api/v1/tasks/:taskId/comments` | POST | P2 | 2 | US-016 |
| 4.2 | コメント一覧取得 | `/api/v1/tasks/:taskId/comments` | GET | P2 | 2 | US-016 |
| 4.3 | コメント更新 | `/api/v1/comments/:id` | PUT | P2 | 2 | US-017 |
| 4.4 | コメント削除 | `/api/v1/comments/:id` | DELETE | P3 | 3 | US-018 |

**実装メモ**:
- メンション機能（@username）の検出
- コメント一覧は作成日時の新しい順

---

## 5. ラベル

| # | 機能 | エンドポイント | メソッド | 優先度 | Phase | US |
|---|------|----------------|----------|--------|-------|-----|
| 5.1 | ラベル作成 | `/api/v1/projects/:projectId/labels` | POST | P2 | 2 | US-019 |
| 5.2 | ラベル一覧取得 | `/api/v1/projects/:projectId/labels` | GET | P2 | 2 | US-019 |
| 5.3 | ラベル更新 | `/api/v1/labels/:id` | PUT | P2 | 2 | - |
| 5.4 | ラベル削除 | `/api/v1/labels/:id` | DELETE | P3 | 3 | - |
| 5.5 | タスクにラベル付与 | `/api/v1/tasks/:taskId/labels` | POST | P2 | 2 | US-020 |
| 5.6 | タスクからラベル削除 | `/api/v1/tasks/:taskId/labels/:labelId` | DELETE | P2 | 2 | US-020 |

**実装メモ**:
- ラベル名はプロジェクト内でユニーク
- 色は HEX形式（例: #FF5733）

---

## 6. メンバー管理

| # | 機能 | エンドポイント | メソッド | 優先度 | Phase | US |
|---|------|----------------|----------|--------|-------|-----|
| 6.1 | メンバー招待 | `/api/v1/projects/:projectId/members` | POST | P2 | 2 | US-021 |
| 6.2 | メンバー一覧取得 | `/api/v1/projects/:projectId/members` | GET | P2 | 2 | US-022 |
| 6.3 | メンバー権限変更 | `/api/v1/projects/:projectId/members/:userId` | PATCH | P3 | 3 | US-023 |
| 6.4 | メンバー削除 | `/api/v1/projects/:projectId/members/:userId` | DELETE | P3 | 3 | US-024 |

**実装メモ**:
- 招待はメールアドレスまたはユーザーIDで指定
- ロール: Owner/Member/Viewer

---

## 7. 統計・レポート（将来機能）

| # | 機能 | エンドポイント | メソッド | 優先度 | Phase | US |
|---|------|----------------|----------|--------|-------|-----|
| 7.1 | プロジェクト進捗取得 | `/api/v1/projects/:id/stats` | GET | P3 | - | - |
| 7.2 | ユーザー作業時間取得 | `/api/v1/users/me/stats` | GET | P3 | - | - |
| 7.3 | タスク完了率 | `/api/v1/projects/:id/completion` | GET | P3 | - | - |

**実装メモ**:
- Phase 3以降で検討
- ダッシュボード表示用

---

## 8. 通知（将来機能）

| # | 機能 | エンドポイント | メソッド | 優先度 | Phase | US |
|---|------|----------------|----------|--------|-------|-----|
| 8.1 | 通知一覧取得 | `/api/v1/notifications` | GET | P3 | - | - |
| 8.2 | 通知既読化 | `/api/v1/notifications/:id/read` | PATCH | P3 | - | - |
| 8.3 | 通知全既読化 | `/api/v1/notifications/read-all` | POST | P3 | - | - |

**実装メモ**:
- Phase 3以降で検討
- イベント: タスク割り当て、コメントメンション

---

## Phase別実装計画

### Phase 1: MVP（Day68-74）
**目標**: 基本的なタスク管理ができる

**実装する機能（P0 + P1）**:
- ✅ 認証（登録、ログイン、プロフィール取得）
- ✅ プロジェクト管理（作成、一覧、詳細、更新）
- ✅ タスク管理（作成、一覧、詳細、更新、ステータス変更）

**エンドポイント数**: 13個

**達成基準**:
- ユーザーがプロジェクトを作成できる
- タスクを作成し、ステータスを管理できる
- 自分のタスク一覧を確認できる

---

### Phase 2: コラボレーション（Day75-85）
**目標**: チームでの協力ができる

**実装する機能（P2）**:
- ✅ コメント機能
- ✅ ラベル機能
- ✅ メンバー管理（招待、一覧）

**追加エンドポイント数**: 10個
**累計エンドポイント数**: 23個

**達成基準**:
- タスクに議論できる（コメント）
- タスクを分類できる（ラベル）
- チームメンバーを招待できる

---

### Phase 3: 高度な機能（Day86-100）
**目標**: 運用に必要な機能を追加

**実装する機能（P3）**:
- ✅ 削除機能（プロジェクト、タスク、コメント、メンバー）
- ✅ 統計・レポート
- ✅ 通知機能

**追加エンドポイント数**: 10個以上
**累計エンドポイント数**: 33個以上

**達成基準**:
- 不要なデータを削除できる
- プロジェクトの進捗を可視化できる
- タスク割り当て時に通知される

---

## 非機能要件と機能の紐付け

### パフォーマンス要件
- **タスク一覧取得**: 10,000件でも1秒以内 → ページネーション、インデックス
- **タスク検索**: 全文検索で1秒以内 → PostgreSQLのfull-text search

### セキュリティ要件
- **認証**: 全エンドポイントで認証必須（/auth以外）
- **認可**: プロジェクトメンバーのみアクセス可能
- **入力検証**: 全エンドポイントでバリデーション

### スケーラビリティ
- **同時接続**: 50ユーザーまで対応
- **データ量**: タスク10,000件、プロジェクト100件

---

## エンドポイント命名規則

### RESTful原則に従う
- リソース名は複数形（`/projects`, `/tasks`）
- HTTPメソッドで操作を表現（GET/POST/PUT/PATCH/DELETE）
- ネスト構造は2階層まで（`/projects/:id/tasks`）

### バージョニング
- APIバージョンをパスに含める（`/api/v1/...`）
- 破壊的変更がある場合はv2を作成

### 特殊な操作
- サブリソースの操作: `/tasks/:id/status` (PATCH)
- 一括操作: `/tasks/bulk` (PATCH)
- カスタム操作: `/projects/:id/archive` (POST)

---

## 機能実装の依存関係

```
認証
  │
  ├─→ プロジェクト管理
  │     │
  │     ├─→ タスク管理（プロジェクトに依存）
  │     │     │
  │     │     ├─→ コメント（タスクに依存）
  │     │     └─→ ラベル（タスクとプロジェクトに依存）
  │     │
  │     └─→ メンバー管理（プロジェクトに依存）
  │
  └─→ 通知（すべてに依存）
```

**実装順序**:
1. 認証・ユーザー管理
2. プロジェクト管理
3. タスク管理
4. コメント・ラベル
5. メンバー管理
6. 通知・統計

---

## テストカバレッジ目標

| 機能カテゴリ | 単体テスト | 結合テスト | E2Eテスト |
|--------------|-----------|-----------|-----------|
| 認証 | 95%+ | 必須 | 必須 |
| プロジェクト | 80%+ | 必須 | 推奨 |
| タスク | 85%+ | 必須 | 必須 |
| コメント | 80%+ | 推奨 | - |
| ラベル | 75%+ | 推奨 | - |
| メンバー | 80%+ | 推奨 | - |

---

**作成日**: 2026-01-06
**作成者**: 学習プロジェクト
**バージョン**: 1.0
**機能数**: 33機能（Phase 1: 13, Phase 2: 10, Phase 3: 10+）
